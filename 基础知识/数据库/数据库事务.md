# 数据库事务

定义：事务（Transaction）是由一系列对系统中数据进行访问与更新的操作所组成的一个程序执行逻辑单元。

### 基本特征

- 原子性

事务必须是一个原子操作序列单元，事务内的操作，要么全部完成，要么都不完成，完成部分失败后要回滚成功的操作。所有操作序列成功，整个事务才算执行成功。

- 一致性

事务完成前后不能破坏数据库的一致性和完整性

- 隔离性

两个事务可以并发执行，对数据处理是隔离的，有四个级别

- 持久性

事务提交后，必须已经保存更改，提交后发生断电、宕机等事故，重启后数据是提交后的样子

### 事务隔离级别

- #### 读未提及

换句话说，如果一个事务正在处理某一数据，并对其进行了更新，但同时尚未完成事务，因此还没有提交事务；而以此同时，允许另一个事务也能够访问该数据。

> 隔离级别最低
>
> 并发性最高
>
> 会产生脏读

- #### 读已提交

读已提交是不同的时候执行的时候只能获取到已经提交的数据。

> 可避免脏读
>
> 产生不可重复读问题

- #### 可重复读

可重复读就是保证在事务处理过程中，多次读取同一个数据时，该数据的值和事务开始时刻是一致的。

> 可避免不可重复读问题
>
> 出现幻读问题

- #### 顺序读

顺序读是最严格的事务隔离级别。它要求所有的事务排队顺序执行，即事务只能一个接一个地处理，不能并发。

> 隔离级别最高，安全性最高
>
> 并发性没有

### 各种问题

- #### 脏读

在一个事务里读取了另一个事务里还未提交的数据

- #### 不可重复读

在一个事务内，多次读同一数据返回的值不同

- #### 幻读

在一个事务操作时，其他事务不能修改数据，解决了不可重复读问题，但是其他事务可以插入新的数据，前一个事务读取值虽然不变，但是多了数据，彷佛出现幻觉